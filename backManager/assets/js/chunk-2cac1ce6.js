(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2cac1ce6"],{"0c42":function(e,o,t){"use strict";var r=t("da11"),a=t.n(r);a.a},da11:function(e,o,t){},fcd6:function(e,o,t){"use strict";t.r(o);var r=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("div",{staticClass:"text-box"},[t("el-tabs",{model:{value:e.activeName,callback:function(o){e.activeName=o},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"新建优惠券",name:"first"}},[t("el-form",{ref:"form",attrs:{rules:e.rules,model:e.form,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"优惠券名称",prop:"couponName"}},[t("el-col",{attrs:{span:11}},[t("el-input",{model:{value:e.form.couponName,callback:function(o){e.$set(e.form,"couponName",o)},expression:"form.couponName"}})],1)],1),t("el-form-item",{attrs:{label:"发送总量",prop:"totalCount"}},[t("el-col",{attrs:{span:11}},[t("el-input",{attrs:{type:"number"},model:{value:e.form.totalCount,callback:function(o){e.$set(e.form,"totalCount",o)},expression:"form.totalCount"}})],1)],1),t("el-form-item",{attrs:{label:"优惠方式",prop:"couponType"}},[t("el-col",{attrs:{span:11}},[t("div",[t("el-radio-group",{model:{value:e.form.couponType,callback:function(o){e.$set(e.form,"couponType",o)},expression:"form.couponType"}},[t("el-radio",{attrs:{label:"0"}},[e._v("无门槛")]),t("el-radio",{attrs:{label:"1"}},[t("span",[t("span",[e._v("满减券")]),t("span",[e._v(" 满 "),t("el-input",{staticStyle:{width:"100px"},attrs:{type:"number"},model:{value:e.form.useMinPrice,callback:function(o){e.$set(e.form,"useMinPrice",o)},expression:"form.useMinPrice"}}),e._v(" 可使用")],1)])])],1)],1)])],1),t("el-form-item",{attrs:{label:"优惠券面值",prop:"couponPrice"}},[t("el-col",{attrs:{span:11}},[t("el-input",{attrs:{type:"number"},model:{value:e.form.couponPrice,callback:function(o){e.$set(e.form,"couponPrice",o)},expression:"form.couponPrice"}})],1)],1),t("el-form-item",{attrs:{label:"领取数限制",prop:"quantityLimit"}},[t("el-col",{attrs:{span:11}},[t("el-input",{attrs:{type:"number"},model:{value:e.form.quantityLimit,callback:function(o){e.$set(e.form,"quantityLimit",o)},expression:"form.quantityLimit"}})],1)],1),t("el-form-item",{attrs:{label:"生效日期",prop:"useTime"}},[t("el-col",{attrs:{span:11}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.dateChange},model:{value:e.form.useTime,callback:function(o){e.$set(e.form,"useTime",o)},expression:"form.useTime"}})],1)],1),t("el-form-item",{attrs:{label:"可使用商品",prop:"productType"}},[t("el-col",{attrs:{span:11}},[t("div",[t("el-radio-group",{model:{value:e.form.productType,callback:function(o){e.$set(e.form,"productType",o)},expression:"form.productType"}},[t("el-radio",{attrs:{label:"0"}},[e._v("不限制")]),t("el-radio",{attrs:{label:"1"}},[t("span",[t("span",[e._v("限制  ")]),t("span",[t("el-select",{attrs:{disabled:"1"!==e.form.productType,placeholder:"请选择"},model:{value:e.form.usableGoods,callback:function(o){e.$set(e.form,"usableGoods",o)},expression:"form.usableGoods"}},e._l(e.productList,(function(e){return t("el-option",{key:e.id,attrs:{label:e.productName,value:e.id}})})),1)],1)])])],1)],1)])],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmit}},[e._v("确定")]),t("el-button",{staticStyle:{width:"100px"},on:{click:e.goBack}},[e._v("返回")])],1)],1)],1)],1)],1)},a=[],i=t("365c"),s={data:function(){return{activeName:"first",form:{couponName:"",couponPrice:"",couponType:"0",endTime:0,quantityLimit:0,startTime:0,totalCount:"",usableGoods:"",useMinPrice:"",productType:"0",useTime:""},rules:{couponName:[{required:!0,message:"请输入优惠券",trigger:"blur"}],totalCount:[{required:!0,message:"请输入发送总量",trigger:"blur"}],couponType:[{required:!0,message:"请输入优惠方式",trigger:"blur"}],couponPrice:[{required:!0,message:"请输入优惠券面值",trigger:"blur"}],quantityLimit:[{required:!0,message:"请输入领取数量限制",trigger:"blur"}],useTime:[{required:!0,message:"请选择生效日期",trigger:"blur"}],productType:[{required:!0,message:"请选择限制商品",trigger:"blur"}]},productList:[],loading:!1}},methods:{goBack:function(){this.$router.go(-1)},onSubmit:function(){var e=this;console.log("submit!"),this.$refs["form"].validate((function(o){if(console.log("valid",o),o){if(e.loading=!0,console.log("提交的内容为:",e.form),"0"===e.form.couponType&&!e.form.useMinPrice)return e.$message({message:"请设置满减门槛",type:"error"}),!1;if("1"===e.form.productType&&!e.form.usableGoods)return e.$message({message:"请选择限制使用商品",type:"error"}),!1;var t={};e.form.id?(t={id:e.form.id,couponName:e.form.couponName,couponPrice:Number(e.form.couponPrice),couponType:Number(e.form.couponType),endTime:e.form.endTime,quantityLimit:Number(e.form.quantityLimit),startTime:e.form.startTime,totalCount:Number(e.form.totalCount),usableGoods:e.form.usableGoods?e.form.usableGoods.toString():"",useMinPrice:Number(e.form.useMinPrice)},Object(i["j"])(t).then((function(o){e.loading=!1,1===o.code?e.goBack():e.$message({message:o.msg,type:"error"})}),(function(o){e.loading=!1,console.log(o),e.$message({message:"网络连接失败",type:"error"})}))):(t={couponName:e.form.couponName,couponPrice:Number(e.form.couponPrice),couponType:Number(e.form.couponType),endTime:e.form.endTime,quantityLimit:Number(e.form.quantityLimit),startTime:e.form.startTime,totalCount:Number(e.form.totalCount),usableGoods:e.form.usableGoods?e.form.usableGoods.toString():"",useMinPrice:Number(e.form.useMinPrice)},Object(i["g"])(t).then((function(o){e.loading=!1,1===o.code?e.goBack():e.$message({message:o.msg,type:"error"})}),(function(o){e.loading=!1,console.log(o),e.$message({message:"网络连接失败",type:"error"})})))}}))},dateChange:function(e){console.log("日期选择变化:",e),e?(this.form.useTime=e,this.form.startTime=new Date(e[0]).getTime()/100,this.form.endTime=new Date(e[1]).getTime()/100):(this.form.useTime=e,this.form.startTime="",this.form.endTime=""),console.log(this.form)},getProductList:function(){var e=this,o={pageNumber:0,pageSize:1e5};Object(i["e"])(o).then((function(o){1===o.code?e.productList=o.data.pageList:e.$message({message:o.msg,type:"error"})}),(function(o){console.log(o),e.$message({message:"网络连接失败",type:"error"})}))}},mounted:function(){var e=this.$route.query.coupon;console.log("页面传入数据:",e),e&&(e.couponType=e.couponType.toString(),e.usableGoods?e.productType="1":e.productType="0",e.startTime&&e.endTime&&(this.useTime=[new Date(e.startTime),new Date(e.endTime)],e.useTime=[new Date(e.startTime),new Date(e.endTime)],e.startTime=new Date(e.startTime).getTime()/100,e.endTime=new Date(e.endTime).getTime()/100),this.form=Object.assign({},e)),console.log(this.form),this.getProductList()}},n=s,m=(t("0c42"),t("2877")),u=Object(m["a"])(n,r,a,!1,null,"b83d3ebc",null);o["default"]=u.exports}}]);